<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.089c4e8d70865e42a4a9.css" data-identity="gatsby-global-css">/*! tailwindcss v2.2.16 | MIT License | https://tailwindcss.com*/

/*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */html{-webkit-text-size-adjust:100%;line-height:1.15;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;margin:0}hr{color:inherit;height:0}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],button{-webkit-appearance:button}legend{padding:0}progress{vertical-align:baseline}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{font-family:inherit;line-height:inherit}*,:after,:before{border:0 solid;box-sizing:border-box}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a1a1aa;opacity:1}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a1a1aa;opacity:1}input::placeholder,textarea::placeholder{color:#a1a1aa;opacity:1}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{color:inherit;line-height:inherit;padding:0}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{border-color:currentColor}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.top-0{top:0}.bottom-0{bottom:0}.left-0{left:0}.z-10{z-index:10}.z-20{z-index:20}.z-50{z-index:50}.m-3{margin:.75rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-3{margin-left:.75rem;margin-right:.75rem}.mx-5{margin-left:1.25rem;margin-right:1.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-3{margin-bottom:.75rem;margin-top:.75rem}.my-4{margin-bottom:1rem;margin-top:1rem}.my-8{margin-bottom:2rem;margin-top:2rem}.mt-0{margin-top:0}.mt-1{margin-top:.25rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-5{margin-top:1.25rem}.mt-8{margin-top:2rem}.mt-12{margin-top:3rem}.mt-20{margin-top:5rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.mb-6{margin-bottom:1.5rem}.mb-12{margin-bottom:3rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.box-border{box-sizing:border-box}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.table{display:table}.hidden{display:none}.h-6{height:1.5rem}.h-8{height:2rem}.h-12{height:3rem}.h-64{height:16rem}.h-px{height:1px}.h-full{height:100%}.h-screen{height:100vh}.w-12{width:3rem}.w-16{width:4rem}.w-40{width:10rem}.w-auto{width:auto}.w-4\/5{width:80%}.w-full{width:100%}.max-w-none{max-width:none}.flex-1{flex:1 1 0%}.transform{--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-0{--tw-scale-x:0;--tw-scale-y:0}.scale-100{--tw-scale-x:1;--tw-scale-y:1}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{opacity:0;transform:scale(2)}}@keyframes ping{75%,to{opacity:0;transform:scale(2)}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}@keyframes bounce{0%,to{-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}.resize-none{resize:none}.resize{resize:both}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.overflow-hidden{overflow:hidden}.whitespace-pre{white-space:pre}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.border-2{border-width:2px}.border-t-2{border-top-width:2px}.border-primary{--tw-border-opacity:1;border-color:rgba(71,87,110,var(--tw-border-opacity))}.border-secondary{--tw-border-opacity:1;border-color:rgba(62,62,62,var(--tw-border-opacity))}.hover\:border-primary:hover{--tw-border-opacity:1;border-color:rgba(71,87,110,var(--tw-border-opacity))}.bg-bg{background-color:rgba(248,248,248,var(--tw-bg-opacity))}.bg-bg,.bg-bgalt{--tw-bg-opacity:1}.bg-bgalt{background-color:rgba(255,255,255,var(--tw-bg-opacity))}.bg-cover{background-size:cover}.stroke-current{stroke:currentColor}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-2px{padding:2px}.px-0{padding-left:0;padding-right:0}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-5{padding-bottom:1.25rem;padding-top:1.25rem}.py-6{padding-bottom:1.5rem;padding-top:1.5rem}.py-12{padding-bottom:3rem;padding-top:3rem}.pt-1{padding-top:.25rem}.pt-3{padding-top:.75rem}.pt-4{padding-top:1rem}.pt-6{padding-top:1.5rem}.pt-8{padding-top:2rem}.pb-6{padding-bottom:1.5rem}.pb-20{padding-bottom:5rem}.pb-40{padding-bottom:10rem}.pl-2{padding-left:.5rem}.text-center{text-align:center}.align-middle{vertical-align:middle}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-5xl{font-size:3rem;line-height:1}.text-6xl{font-size:3.75rem;line-height:1}.text-7xl{font-size:5rem}.font-bold{font-weight:700}.uppercase{text-transform:uppercase}.text-color-default{--tw-text-opacity:1;color:rgba(62,62,62,var(--tw-text-opacity))}.text-color-1{--tw-text-opacity:1;color:rgba(71,87,110,var(--tw-text-opacity))}.text-color-2{--tw-text-opacity:1;color:rgba(116,164,188,var(--tw-text-opacity))}.text-color-3{--tw-text-opacity:1;color:rgba(242,101,34,var(--tw-text-opacity))}.text-color-4{--tw-text-opacity:1;color:rgba(62,62,62,var(--tw-text-opacity))}.text-primary{--tw-text-opacity:1;color:rgba(71,87,110,var(--tw-text-opacity))}.text-secondary{--tw-text-opacity:1;color:rgba(62,62,62,var(--tw-text-opacity))}.text-link{--tw-text-opacity:1;color:rgba(242,101,34,var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity))}.focus\:text-primary:focus{--tw-text-opacity:1;color:rgba(71,87,110,var(--tw-text-opacity))}*,:after,:before{--tw-shadow:0 0 #0000}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06)}.shadow,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04)}.focus\:shadow-2xl:focus,.hover\:shadow-2xl:hover,.shadow-2xl{--tw-shadow:0 25px 50px -12px rgba(0,0,0,0.25);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.focus\:outline-none:focus,.outline-none{outline:2px solid transparent;outline-offset:2px}*,:after,:before{--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000}.filter{--tw-blur:var(--tw-empty,/*!*/ /*!*/);--tw-brightness:var(--tw-empty,/*!*/ /*!*/);--tw-contrast:var(--tw-empty,/*!*/ /*!*/);--tw-grayscale:var(--tw-empty,/*!*/ /*!*/);--tw-hue-rotate:var(--tw-empty,/*!*/ /*!*/);--tw-invert:var(--tw-empty,/*!*/ /*!*/);--tw-saturate:var(--tw-empty,/*!*/ /*!*/);--tw-sepia:var(--tw-empty,/*!*/ /*!*/);--tw-drop-shadow:var(--tw-empty,/*!*/ /*!*/);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-shadow{transition-duration:.15s;transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-transform{transition-duration:.15s;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.theme-dark .bg-bg{background-color:#3e3e3e}.theme-dark .bg-bgalt{background-color:#000}.theme-dark .border-primary{border-color:#f8f8f8}.theme-dark .border-secondary{border-color:#fff}.theme-dark .text-color-default{color:#a8a8aa}.theme-dark .text-color-1,.theme-dark .text-primary{color:#f8f8f8}.theme-dark .text-secondary{color:#fff}.bg-gradient-primary{background-image:linear-gradient(90deg,#47576e,#3e3e3e)}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}:root{--deckgo-highlight-code-carbon-toolbar-display:none;--deckgo-highlight-code-carbon-overflow:scroll;--deckgo-highlight-code-scroll:scroll;--deckgo-highlight-code-width:max-content;--deckgo-highlight-code-carbon-margin:30px 20px}body{font-family:Didact Gothic,sans-serif;font-size:18px}p{line-height:165%}.boxed{margin-left:auto;margin-right:auto;max-width:1024px;padding-left:1rem;padding-right:1rem;width:100%}.large-container{max-width:2100px}@media (min-width:1024px){.boxed{max-width:768px}}@media (min-width:1280px){.boxed{max-width:1024px}}.nav .nav-links li{display:inline-block;margin-left:.5rem;margin-right:.5rem;position:relative}.nav .nav-links li a{display:inline-block;padding:.25rem;position:relative;z-index:10}.nav .nav-links li:before{--tw-bg-opacity:1;background-color:rgba(71,87,110,var(--tw-bg-opacity));border-radius:9999px;bottom:0;content:"";height:0;left:0;margin:auto;opacity:.25;position:absolute;right:0;top:0;width:0}.theme-dark .nav .nav-links li:before{background-color:#f8f8f8}.nav .nav-links li:before{transition:width .25s,height .25s}.nav .nav-links li.active a,.nav .nav-links li:hover a{color:#f26522}.nav .nav-links .theme-switcher:before{display:none}.nav .line{transition:width .5s;width:0}.nav.scrolled .line{width:100%}.title h1{--tw-text-opacity:1;color:rgba(71,87,110,var(--tw-text-opacity))}.theme-dark .title h1{color:#f8f8f8}.btn{align-items:center;display:inline-flex;height:3rem;outline:2px solid transparent;outline-offset:2px;overflow:hidden;padding-left:1.5rem;padding-right:1.5rem;position:relative}.btn.disabled{opacity:.5}.btn span{position:relative;z-index:10}.btn:before{content:"";height:100%;left:100%;position:absolute;top:0;transition:left .25s;transition-timing-function:cubic-bezier(1,2.13,1,-.1);width:100%;z-index:1}.btn .icon-right{margin-left:.75rem}.btn .icon-left{margin-right:.75rem}.btn:focus{outline:2px solid transparent;outline-offset:2px}.btn-primary{--tw-bg-opacity:1;background-color:rgba(71,87,110,var(--tw-bg-opacity));margin-bottom:1rem;margin-top:1rem}.theme-dark .btn-primary{background-color:#f8f8f8}.btn-primary{color:#fff}.btn-primary:before{--tw-bg-opacity:1;background-color:rgba(62,62,62,var(--tw-bg-opacity))}.theme-dark .btn-primary:before{background-color:#fff}.btn-primary:focus:before,.btn-primary:hover:before{left:0}.integration-item .image{-webkit-clip-path:polygon(0 0,0 0,0 100%,0 100%);clip-path:polygon(0 0,0 0,0 100%,0 100%);transform:translateY(0);transition:-webkit-clip-path .5s;transition:clip-path .5s;transition:clip-path .5s,-webkit-clip-path .5s;transition-timing-function:ease-in-out;z-index:3}.integration-item.even .image{-webkit-clip-path:polygon(100% 0,100% 0,100% 99%,100% 100%);clip-path:polygon(100% 0,100% 0,100% 99%,100% 100%)}.integration-item.begin-animation .image{-webkit-clip-path:polygon(0 0,100% 0,100% 100%,0 100%);clip-path:polygon(0 0,100% 0,100% 100%,0 100%)}.integration-item .to-up{transform:translateY(50px);transition:transform .25s}.integration-item .to-up:nth-child(2){transition-delay:.2s}.integration-item.begin-animation .to-up{transform:translate(0)}.footer-links li{margin-left:.75rem;margin-right:.75rem}.animated-link-parent a{display:inline-block;position:relative}.animated-link-parent a:after{background-image:linear-gradient(90deg,#47576e,#3e3e3e);bottom:0;content:"";height:2px;left:0;position:absolute;transition-duration:.3s;transition-property:width;width:0}.animated-link-parent a:active:after,.animated-link-parent a:focus:after,.animated-link-parent a:hover:after{width:100%}.post-content p{margin-bottom:.75rem;margin-top:.75rem}.post-content h1,h2,h3,h4,h5,h6{--tw-text-opacity:1;color:rgba(116,164,188,var(--tw-text-opacity));margin-bottom:2rem;margin-top:2rem}.post-content h1{font-size:3rem;line-height:1}.post-content h2{font-size:2.25rem;line-height:2.5rem}.post-content h3{font-size:1.875rem;line-height:2.25rem}.post-content h4{font-size:1.5rem;line-height:2rem}.post-content h5{font-size:1.25rem;font-size:1.125rem;line-height:1.75rem}.post-content hr{--tw-border-opacity:1;border-color:rgba(207,216,220,var(--tw-border-opacity));margin-bottom:1rem;margin-top:1rem}.theme-dark .post-content hr{border-color:#222}.post-content ul{list-style:disc}.post-content ol{list-style:decimal}.post-content ol,.post-content ul{margin-left:1rem}.post-content ol ol,.post-content ul ul{margin-left:.75rem}.post-content li{margin-bottom:.5rem;margin-left:1.5rem;margin-top:.5rem}.post-content table{margin-bottom:1.5rem;margin-top:1.5rem;width:100%}.post-content table tr{--tw-border-opacity:1;border-bottom:2px solid #eee;border-bottom-color:rgba(207,216,220,var(--tw-border-opacity));border-left-color:rgba(207,216,220,var(--tw-border-opacity));border-right-color:rgba(207,216,220,var(--tw-border-opacity));border-top-color:rgba(207,216,220,var(--tw-border-opacity))}.theme-dark .post-content table tr{border-color:#222;border-bottom:2px solid #444}.post-content table tr td,.post-content table tr th{padding:.75rem .5rem;text-align:left}.post-content blockquote{--tw-border-opacity:1;border-color:rgba(71,87,110,var(--tw-border-opacity));border-left-width:4px;padding:.75rem}.theme-dark .post-content blockquote{border-color:#f8f8f8}.post-content blockquote{margin:1.5rem 0;padding:0 .75rem}.post-content iframe{max-width:100%}.input.focused{padding-left:1rem;padding-right:1rem}.theme-dark .blog-item .focused,.theme-dark .input.focused{background:#222}.spin{-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@media (max-width:640px){html{font-size:15px}}.post-content a{--tw-text-opacity:1;color:rgba(116,164,188,var(--tw-text-opacity));margin-bottom:1rem;margin-top:1rem}.post-content pre{background-color:#333;color:#fff;margin:2rem;overflow:scroll;padding:1rem}.int-title{color:#fff!important}.integration-list{background-color:#fff;margin:30px auto auto;width:90%}.integration-list td{border:3px solid #f8f8f8;padding:8px 13px;vertical-align:top}.integration-list th{border:3px solid #f8f8f8;padding:10px}.int-desc{width:50%}.table-of-contents{background-color:#fff;float:right;margin:10px 0 10px 20px;padding:10px 0}.table-of-contents ol{counter-reset:tocnum;list-style:none;margin-left:0;padding-left:10px}.table-of-contents ol li{counter-increment:tocnum;line-height:100%;margin-left:10px;padding-left:0;padding-right:10px}.table-of-contents ol li:before{content:counters(tocnum,".") ". ";font-weight:700}code{background-color:#dedede;font-size:.85rem;padding:.25rem .5rem}h1,h2,h3,h4,h5,h6{margin-bottom:1.5rem;margin-top:1.5rem}@media (min-width:640px){.sm\:w-full{width:100%}}@media (min-width:768px){.md\:mt-6{margin-top:1.5rem}.md\:-mt-16{margin-top:-4rem}.md\:w-1\/2{width:50%}.md\:w-11\/12{width:91.666667%}.md\:w-full{width:100%}.md\:px-4{padding-left:1rem;padding-right:1rem}}@media (min-width:1024px){.lg\:relative{position:relative}.lg\:mt-12{margin-top:3rem}.lg\:box-content{box-sizing:content-box}.lg\:block{display:block}.lg\:flex{display:flex}.lg\:hidden{display:none}.lg\:h-auto{height:auto}.lg\:w-1\/2{width:50%}.lg\:w-1\/3{width:33.333333%}.lg\:w-2\/3{width:66.666667%}.lg\:w-3\/4{width:75%}.lg\:w-4\/5{width:80%}.lg\:w-full{width:100%}.lg\:justify-between{justify-content:space-between}.lg\:p-4{padding:1rem}.lg\:px-0{padding-left:0;padding-right:0}.lg\:py-14{padding-bottom:3.5rem;padding-top:3.5rem}.lg\:pt-0{padding-top:0}.lg\:pl-8{padding-left:2rem}.lg\:text-left{text-align:left}.lg\:text-lg{font-size:1.125rem;line-height:1.75rem}.lg\:text-xl{font-size:1.25rem;line-height:1.75rem}.lg\:text-4xl{font-size:2.25rem;line-height:2.5rem}.lg\:text-6xl{font-size:3.75rem;line-height:1}.lg\:text-7xl{font-size:5rem}.lg\:text-color-default{--tw-text-opacity:1;color:rgba(62,62,62,var(--tw-text-opacity))}.theme-dark .lg\:text-color-default{color:#a8a8aa}}</style><meta name="generator" content="Gatsby 3.14.1"/><title data-react-helmet="true">Tracing Data Lineage with OpenLineage and Apache Spark | OpenLineage</title><link data-react-helmet="true" rel="icon" href="/images/icon.svg" type="image/png"/><link data-react-helmet="true" href="https://fonts.googleapis.com/css2?family=Didact+Gothic&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="Spark ushered in a brand new age of data democratization... and left us with a mess of hidden dependencies, stale datasets, and failed jobs."/><meta data-react-helmet="true" property="og:title" content="Tracing Data Lineage with OpenLineage and Apache Spark"/><meta data-react-helmet="true" property="og:description" content="Spark ushered in a brand new age of data democratization... and left us with a mess of hidden dependencies, stale datasets, and failed jobs."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@openlineage"/><meta data-react-helmet="true" name="twitter:title" content="Tracing Data Lineage with OpenLineage and Apache Spark"/><meta data-react-helmet="true" name="twitter:description" content="Spark ushered in a brand new age of data democratization... and left us with a mess of hidden dependencies, stale datasets, and failed jobs."/><meta data-react-helmet="true" property="og:image" content="/static/fce9725664865a23fbd7ecc6976c1f5a/banner.svg"/><script data-react-helmet="true" defer="" data-domain="openlineage.io" src="https://plausible.io/js/script.outbound-links.js"></script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-199717351-1', 'auto', {});
      
      
      
      
      
      }</script><link as="script" rel="preload" href="/webpack-runtime-f31cb342322c040ab001.js"/><link as="script" rel="preload" href="/framework-c3c70a738d76c2aa5adb.js"/><link as="script" rel="preload" href="/app-451991c301b94b91c1ec.js"/><link as="script" rel="preload" href="/commons-6492f9ca47f71b394b27.js"/><link as="script" rel="preload" href="/03af1e3b4838e2bf1feefdfdd4602b9a79f8e4c9-6dd2fc84b6bd0dd0e21b.js"/><link as="script" rel="preload" href="/component---src-templates-blog-tsx-ea74284cf1c1eab694cf.js"/><link as="fetch" rel="preload" href="/page-data/blog/openlineage-spark/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1139857438.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1946588481.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2083862410.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2213455283.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2418326273.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3067102388.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="wrapper theme-light"><div class="text-color-default bg-bg"><div class="duration-300 transition-all flex justify-center lg:justify-between items-center z-20 fixed w-full nav p-5"><button class="absolute text-primary outline-0 lg:hidden" style="transform:translateY(-50%);top:50%;left:10px"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button><div class="r-swipe-sidebar-container" style="position:absolute"><div class="r-swipe-sidebar" style="position:fixed;left:-100%;width:70%;height:100%;top:0;z-index:9999;transition-property:left;transition-duration:0s;transition-timing-function:linear;transform:translate3d(0,0,0)"><div class="bg-bg h-full flex flex-col justify-center relative"><div class="absolute top-0 my-4 text-center w-full"><a title="OpenLineage" class="inline-block" href="/"><img src="/images/ol-logo.svg" alt="OpenLineage - logo" class="duration-300 transition-all h-8"/></a></div><div class="text-center"><ul class=""><li class="block my-2 "><a title="Home" class="text-color-2 focus:text-primary" href="/"><span>Home</span></a></li><li class="block my-2 "><a title="Getting Started" class="text-color-2 focus:text-primary" href="/getting-started"><span>Getting Started</span></a></li><li class="block my-2 "><a title="Integrations" class="text-color-2 focus:text-primary" href="/integration"><span>Integrations</span></a></li><li class="block my-2 "><a title="Resources" class="text-color-2 focus:text-primary" href="/resources"><span>Resources</span></a></li><li class="block my-2 active"><a title="Blog" class="text-color-2 focus:text-primary" href="/blog"><span>Blog</span></a></li><li class="block my-2 "><a title="Ecosystem" class="text-color-2 focus:text-primary" href="/ecosystem"><span>Ecosystem</span></a></li><li class="block my-2 "><a title="Docs" class="text-color-2 focus:text-primary" href="/docs"><span>Docs</span></a></li></ul></div></div></div><div class="r-swipe-sidebar-overlay" role="button" tabindex="-1" style="position:fixed;top:0;bottom:0;left:-100%;width:100%;height:100%;background:#000;z-index:9998;transition-property:opacity;transition-duration:0s;opacity:0"></div></div><a title="OpenLineage" href="/"><img src="/images/ol-logo.svg" alt="OpenLineage - logo" class="duration-300 transition-all h-8"/></a><div class="hidden lg:block"><ul class="nav-links flex"><li class=" "><a title="Home" class="text-color-2 focus:text-primary" href="/"><span>Home</span></a></li><li class=" "><a title="Getting Started" class="text-color-2 focus:text-primary" href="/getting-started"><span>Getting Started</span></a></li><li class=" "><a title="Integrations" class="text-color-2 focus:text-primary" href="/integration"><span>Integrations</span></a></li><li class=" "><a title="Resources" class="text-color-2 focus:text-primary" href="/resources"><span>Resources</span></a></li><li class=" active"><a title="Blog" class="text-color-2 focus:text-primary" href="/blog"><span>Blog</span></a></li><li class=" "><a title="Ecosystem" class="text-color-2 focus:text-primary" href="/ecosystem"><span>Ecosystem</span></a></li><li class=" "><a title="Docs" class="text-color-2 focus:text-primary" href="/docs"><span>Docs</span></a></li></ul></div><div class="absolute line h-px left-0 bottom-0 bg-gradient-primary"></div></div><div style="height:0px"></div><div class="md:px-4 mt-12 py-6 md:w-11/12 mx-auto"><div class="mx-auto relative"><img src="/static/fce9725664865a23fbd7ecc6976c1f5a/banner.svg" alt="&#x27;&#x27;"/><div class="relative w-full lg:w-3/4 md:w-11/12 sm:w-full p-6 box-border lg:box-content mx-auto bg-bg text-color-default blog-wall-content shadow-xl md:-mt-16 "><div class="p-3"><h1 class="text-5xl font-bold text-primary">Tracing Data Lineage with OpenLineage and Apache Spark</h1><p class="mt-1 flex"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg> <span class="ml-2">05 November 2021<!-- --> by <!-- -->Michael Collado</span></p><p class="mt-3">Spark ushered in a brand new age of data democratization... and left us with a mess of hidden dependencies, stale datasets, and failed jobs.</p></div></div></div><div class="lg:w-3/4 md:w-11/12 sm:w-full p-3 mx-auto mt-12 post-content"><h2 id="the-age-of-data-democratization">The Age of Data Democratization</h2><p>In 2015, Apache Spark seemed to be taking over the world. Many of us had spent the prior few years moving our large
datasets out of the Data Warehouse into &quot;Data Lakes&quot;- repositories of structured and unstructured data in
distributed file systems or object stores, like HDFS or S3. This enabled us to build analytic systems that could
handle traditional, table-structured data alongside flexible, unstructured JSON blobs, giving us access to more data
and allowing us to move much faster than we’d previously been able to.</p><p>The problem was that taking the data out of Data Warehouses meant that the people who really needed access to the
data, analysts and statisticians, could no longer use the tools they were comfortable with in order to read that data.
Where previously, SQL and Python were all that was needed to start exploring and analyzing a dataset, now people needed
to write Java or use specialized scripting languages, like Pig, to get at the data. Systems that did support SQL, such
as Hive, were unbearably slow for any but the most basic operations. In many places, the statisticians were dependent on
software engineers to build custom tools for access, meaning the bottleneck had moved from the systems that
needed to store and process the data to the humans who were supposed to tell us what systems to build.</p><p>Then along came Apache Spark, which gave back to analysts the ability to use their beloved Python (and eventually SQL)
tools to process raw data in object stores without the dependency on software engineers. While others were
attracted to its ability to perform multiple operations on data without the I/O overhead of alternatives, like Pig or
Hive, data scientists were thrilled to start piping that data through their NumPy and Pandas scripts. </p><h2 id="a-colossal-mess">A Colossal Mess</h2><p>Of course, the natural consequence of this data democratization is that it becomes difficult to keep track of who is
using the data and for what purpose. Hidden dependencies and Hyrum’s Law suddenly meant that changes to the data schema
would inadvertently break downstream processes or that stale, deprecated datasets were still being consumed, and that
corrupted datasets would leak into unknown processes making recovery difficult or even impossible.</p><p><a href="https://xkcd.com/1172/"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:278px;margin:3rem">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:138.84892086330936%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFBklEQVQ4y1WU21PaWhTG/Yf70Kc+dDptZ+qgFCIJTSAmQASCuUBywkVuJSBeKh2qeEAgIUlzs7FadKad6aiInIFgzzm/h8zaM/vLWvvbX7JycHCgadrW1hYAACiKiqKIYVg+nx8MBoqiyLKsaVowGHz16tWLFy+ePXv2+vXrUqmkaZqiKCuWZc1ms+l0Onvi8fFx9n+ur69t2764uLBtW1GUX79+udtWzs/Px+Mxz/MgCIZCIRzH6/U6x3G7u7sYhhEEQVFUKpVSFCWbzYqi2O/3Z7PZw8PDXOw4ztXVFYZhlUolHo/TNF0ul3O5XL1e9/v94XA4Go2yLFsul1mW5TiuWCz+/v172dm27bu7O57nT09PO53OwcFBp9MplUq7u7uVSoXn+aOjo729PZ7nc7mcIAgkSQ6Hw6XYcZzLy8tsNisIQqfTyefzsixXF/T7/VartbOz0263a7VaPp/f2dlhGCabzboerZim6Rr2+Pg4mUzc+ufPn6qqKopi27au67e3t66Lj09MJpN5Z1f8x2G3uLi4KJfL6XRaFMVCoeA4zmw2u7+/n06nDwvcbSuGYbTbbRAEfT4fDMMIgrAsGwgEMAyrVqs0TeM4XqvVVFXVnnDryWQy7yyKIoIgyWQylUqFw2GCIDAMSyaTfy0QBEEUxZOTk1ardXx83Ol0jo+Pe73e7e3tPCStVgsEwWazyTDMxsYGAAC5XG59fd3n83Ecx/O8IAgAAHi9XgRBwuEwwzCDweDu7m4+9qdPn3Acj8VigQUEQXAcF41GP378yHFcKpXyer08zxMEsbm56ff7U6nUv+JWq5VIJARB2NraisViFEXBMLy5uRmJRDAM297ehiAoGo1ms1kMwyKRCEVRvV7v/v5+fub9/X0cx9PpdDKZBAAgk8kkk0kURd0pSJJEEGRtbY2iKBzHWZatVquyLM/PbBhGo9Hw+XwIgqAo6vP53EiDIBiPx90XYRiG4zgIgsFgkCRJURSHw+FcbJpmsVh8//49SZKxWCwYDIZCIb/fD8OwaxgAADRNR6NRiqI8Hs+7d+9CodDJycnyqr59+9bpdM7OzlRVHQ6HsiyPRiPTNDVNsyxL07SvX78ahuE+dV0fDoeO4yyzzXHc8+fPPR4PSZLu/LVabfSEsuBPoT4x73x+ft5sNj0eD47jmUwmnU5DELS2thaNRgmCCAQCR0dHg8Gg9x+63e5gMFi6fXl5KUnSaDTSdV2SpH6//2fZ7XZN03Qcx7Is0zQty7IXOI4znU7nncvl8ps3byAIevnyZTAYBEEQhmH32iORCMuyw+FQ/w/uj20+tmVZ9Xp9fX09Fos1Gg035G4qCoUCiqIQBDUajUKhkFngfvDLsW3bbjaboVAolUrlcjmGYdxIxuPx7e3tcDj84cOHTCbjZpNY0Gq1ZFleGnZ4eAjDcKVSQVGUoqhIJCIIQiKRgGGYpuliscgwzOaCQCAAAADDMKqqLjvv7e2trq5CELSxseH1ehmGWV1dffv2LYIgkiT1er2zszPXcEmSut2uu5yLDcO4ubnRdd29TF3X3TyYpmkYxtXV1c2C8Xj848eP79+/j8fj6wVztw8PD7vdbq/XM03T1auq6loiSZJhGJIk/b2g3++rqnp6etput/v9/mg0WimVSjRNV6vVer1OURQIgl++fMEwLB6P5/P5z58/JxIJmqbD4fD+/n6z2SRJkuO4crnMcdw/1Db8ZvsFdtgAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="XKCD 1172" title="XKCD 1172" src="/static/29f80260aa6eb0f5020cced255e32721/4e29d/workflow.png" srcSet="/static/29f80260aa6eb0f5020cced255e32721/4e29d/workflow.png 278w" sizes="(max-width: 278px) 100vw, 278px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></a></p><p>The goal of OpenLineage is to reduce issues and speed up recovery by exposing those hidden dependencies and informing
both producers and consumers of data about the state of that data and the potential blast radius of changes and software
bugs. Naturally, support for Apache Spark seemed like a good idea and, while the Spark 2.4 branch has been supported for
some time, the recent OpenLineage 0.3 release has explicit support for Spark 3.1. 🎉 </p><h2 id="getting-started">Getting Started</h2><p>Our approach to integrating with Spark is not super novel nor is it complicated to integrate into your own system. Spark
has had a SparkListener interface since before the 1.x days. If you&#x27;re a heavy Spark user, it&#x27;s likely you&#x27;re already
familiar with it and how it&#x27;s used in Spark applications. OpenLineage integrates with Spark by implementing that
interface and collecting information about jobs that are executed inside a Spark application. To activate the
listener, add the following properties to your Spark configuration:</p><deckgo-highlight-code terminal="carbon">
          <code slot="code">spark.jars.packages     io.openlineage:openlineage-spark:0.3.+
spark.extraListeners	io.openlineage.spark.agent.OpenLineageSparkListener</code>
        </deckgo-highlight-code><p>This can be added to your cluster’s <code>spark-defaults.conf</code> file, in which case it will record lineage for every job executed on the cluster, or added to specific jobs on submission via the <code>spark-submit</code> command. Once the listener is activated, it needs to know where to report lineage events, as well as the namespace of your jobs. Add the following additional configuration lines to your <code>spark-defaults.conf</code> file or your Spark submission script:</p><deckgo-highlight-code terminal="carbon">
          <code slot="code">spark.openlineage.host		{your.openlineage.host}
spark.openlineage.namespace	{your.openlineage.namespace}</code>
        </deckgo-highlight-code><h2 id="the-demo">The Demo</h2><p>Trying out the Spark integration is super easy if you already have Docker Desktop and git installed. To follow along
with this demo, you’ll also need a Google Cloud account and a Service Account JSON key file for an account that has
access to BigQuery and read/write access to your GCS bucket. I added mine to a file called bq-spark-demo.json.</p><p>Note: If you&#x27;re on macOS Monterey (macOS 12) you&#x27;ll have to release port 5000 before beginning by <a href="https://developer.apple.com/forums/thread/682332">disabling the AirPlay Receiver</a>.</p><p>Check out the OpenLineage project into your workspace with:</p><deckgo-highlight-code language="bash" terminal="carbon">
          <code slot="code">git clone https://github.com/OpenLineage/OpenLineage</code>
        </deckgo-highlight-code><p>Then cd into the integration/spark directory. Run <code>mkdir -p docker/notebooks/gcs</code> and copy your service account credentials
file into that directory. Then run:</p><deckgo-highlight-code language="bash" terminal="carbon">
          <code slot="code">docker-compose up</code>
        </deckgo-highlight-code><p>This launches a Jupyter notebook with Spark already installed as well as a Marquez API endpoint to report lineage. Once the notebook server is up and running, you should see something like the following text in the logs:</p><deckgo-highlight-code terminal="carbon">
          <code slot="code">notebook_1  | [I 21:43:39.014 NotebookApp] Jupyter Notebook 6.4.4 is running at:
notebook_1  | [I 21:43:39.014 NotebookApp] http://082cb836f1ec:8888/?token=507af3cf9c22f627f6c5211d6861fe0804d9f7b19a93ca48
notebook_1  | [I 21:43:39.014 NotebookApp]  or http://127.0.0.1:8888/?token=507af3cf9c22f627f6c5211d6861fe0804d9f7b19a93ca48
notebook_1  | [I 21:43:39.015 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).</code>
        </deckgo-highlight-code><p>Copy the URL with 127.0.0.1 as the hostname from your own log (the token will be different from mine) and paste it into
your browser window. You should have a blank Jupyter notebook environment ready to go.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/bca3fbb89de47ba30f14771725393c88/e9140/jupyter_home.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:30.66666666666667%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiklEQVQY05WR2wrEIAxE/f8fFdYqVtF4i7NEkO3b1oET0MSQMWr0hhgjSm3oPDHne7Z676i1gpmhMhEu62Csw8dcSDljjLGK/tFaW8hAIYT1TknC3wHWBxTKyPk9KSV472GM+TWczLhjgovlyO62TETQWi+7cqckjMHHzTYylfzfPis8NHGm52K2vvhL2E0Aju0LAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Jupyter home screen" title="Jupyter home screen" src="/static/bca3fbb89de47ba30f14771725393c88/c1b63/jupyter_home.png" srcSet="/static/bca3fbb89de47ba30f14771725393c88/5a46d/jupyter_home.png 300w,/static/bca3fbb89de47ba30f14771725393c88/0a47e/jupyter_home.png 600w,/static/bca3fbb89de47ba30f14771725393c88/c1b63/jupyter_home.png 1200w,/static/bca3fbb89de47ba30f14771725393c88/e9140/jupyter_home.png 1226w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>Once your notebook environment is ready, click on the notebooks directory, then click on the New button to create a new
Python 3 notebook.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/117646f4df318133f5aa1f849ab54887/f8836/jupyter_new_notebook.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:30%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoElEQVQY061QWw7DIAzj/jdlpQtQyqsET8nUavtbpVkyEcFyTAz3Bk9P1NYgmHPeZu8dpRQcxwFTasWTPFYKeKyEUqqKmPniGEPFn/V8E21rDUSkxkaOGAKsIzVMKWHf94s5ZxUvywLnnFa5Sz/GCO+99q21mtLIlJQzWh9fqX6lDx7btoEnvxPOycitIpUO5vv7CzGooXxbaPAHnDsXvAAFwdcRvf2CHwAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Jupyter create new notebook" title="Jupyter create new notebook" src="/static/117646f4df318133f5aa1f849ab54887/c1b63/jupyter_new_notebook.png" srcSet="/static/117646f4df318133f5aa1f849ab54887/5a46d/jupyter_new_notebook.png 300w,/static/117646f4df318133f5aa1f849ab54887/0a47e/jupyter_new_notebook.png 600w,/static/117646f4df318133f5aa1f849ab54887/c1b63/jupyter_new_notebook.png 1200w,/static/117646f4df318133f5aa1f849ab54887/f8836/jupyter_new_notebook.png 1214w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>In the first cell in the window paste the following text. Update the GCP project and bucket names and the
service account credentials file, then run the code:</p><deckgo-highlight-code language="python" terminal="carbon">
          <code slot="code">from pyspark.sql import SparkSession
import urllib.request

# download dependencies for BigQuery and GCS
gc_jars = [&#x27;https://repo1.maven.org/maven2/com/google/cloud/bigdataoss/gcs-connector/hadoop3-2.1.1/gcs-connector-hadoop3-2.1.1-shaded.jar&#x27;,
          &#x27;https://repo1.maven.org/maven2/com/google/cloud/bigdataoss/bigquery-connector/hadoop3-1.2.0/bigquery-connector-hadoop3-1.2.0-shaded.jar&#x27;,
          &#x27;https://repo1.maven.org/maven2/com/google/cloud/spark/spark-bigquery-with-dependencies_2.12/0.22.2/spark-bigquery-with-dependencies_2.12-0.22.2.jar&#x27;]

files = [urllib.request.urlretrieve(url)[0] for url in gc_jars]


# Set these to your own project and bucket
project_id = &#x27;bq-openlineage-spark-demo&#x27;
gcs_bucket = &#x27;bq-openlineage-spark-demo-bucket&#x27;
credentials_file = &#x27;/home/jovyan/notebooks/gcs/bq-spark-demo.json&#x27;

spark = (SparkSession.builder.master(&#x27;local&#x27;).appName(&#x27;openlineage_spark_test&#x27;)
             .config(&#x27;spark.jars&#x27;, &quot;,&quot;.join(files))
             
             # Install and set up the OpenLineage listener
             .config(&#x27;spark.jars.packages&#x27;, &#x27;io.openlineage:openlineage-spark:0.3.+&#x27;)
             .config(&#x27;spark.extraListeners&#x27;, &#x27;io.openlineage.spark.agent.OpenLineageSparkListener&#x27;)
             .config(&#x27;spark.openlineage.host&#x27;, &#x27;http://marquez-api:5000&#x27;)
             .config(&#x27;spark.openlineage.namespace&#x27;, &#x27;spark_integration&#x27;)
             
             # Configure the Google credentials and project id
             .config(&#x27;spark.executorEnv.GCS_PROJECT_ID&#x27;, project_id)
             .config(&#x27;spark.executorEnv.GOOGLE_APPLICATION_CREDENTIALS&#x27;, &#x27;/home/jovyan/notebooks/gcs/bq-spark-demo.json&#x27;)
             .config(&#x27;spark.hadoop.google.cloud.auth.service.account.enable&#x27;, &#x27;true&#x27;)
             .config(&#x27;spark.hadoop.google.cloud.auth.service.account.json.keyfile&#x27;, credentials_file)
             .config(&#x27;spark.hadoop.fs.gs.impl&#x27;, &#x27;com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystem&#x27;)
             .config(&#x27;spark.hadoop.fs.AbstractFileSystem.gs.impl&#x27;, &#x27;com.google.cloud.hadoop.fs.gcs.GoogleHadoopFS&#x27;)
             .config(&quot;spark.hadoop.fs.gs.project.id&quot;, project_id)
             .getOrCreate())</code>
        </deckgo-highlight-code><p>Most of this is boilerplate- we need the BigQuery and GCS libraries installed in the notebook environment, then we need
to set the configuration parameters to tell the libraries what GCP project we want to use and how to authenticate with
Google. The parameters specific to OpenLineage are the four we already covered- <code>spark.jars.packages</code>,
<code>spark.extraListeners</code>, <code>spark.openlineage.host</code>, <code>spark.openlineage.namespace</code>. Here, we’ve configured the host to be
the marquez-api container started by Docker.</p><p>Google has a wealth of information available as public datasets in BigQuery. If you’re ever bored one Saturday night,
browse the datasets available- you’ll find census data, crime data, liquor sales, and even a black hole database. For
the demo, I thought I’d browse some of the Covid19 related datasets they have. Specifically, there’s a dataset that
reports the likelihood of people in a given county to wear masks (broken up into five categories: <code>always</code>, <code>frequently</code>,
<code>sometimes</code>, <code>rarely</code>, and <code>never</code>). There’s also a giant dataset called <code>covid19_open_data</code> that contains things like
vaccination rates, current totals of confirmed cases, hospitalizations, deaths, population breakdowns, and policies on
mask-wearing, contact tracing, and vaccination-mandates. Both datasets contain the county FIPS code for US counties,
meaning we can join the two datasets and start exploring.</p><p>Create a new cell in the notebook and paste the following code:</p><deckgo-highlight-code language="python" terminal="carbon">
          <code slot="code">from pyspark.sql.functions import expr, col

mask_use = spark.read.format(&#x27;bigquery&#x27;) \
    .option(&#x27;parentProject&#x27;, project_id) \
    .option(&#x27;table&#x27;, &#x27;bigquery-public-data:covid19_nyt.mask_use_by_county&#x27;) \
    .load() \
    .select(expr(&quot;always + frequently&quot;).alias(&quot;frequent&quot;),
            expr(&quot;never + rarely&quot;).alias(&quot;rare&quot;),
            &quot;county_fips_code&quot;)

opendata = spark.read.format(&#x27;bigquery&#x27;) \
    .option(&#x27;parentProject&#x27;, project_id) \
    .option(&#x27;table&#x27;, &#x27;bigquery-public-data.covid19_open_data.covid19_open_data&#x27;) \
    .load() \
    .filter(&quot;country_name == &#x27;United States of America&#x27;&quot;) \
    .filter(&quot;date == &#x27;2021-10-31&#x27;&quot;) \
    .select(&quot;location_key&quot;,
            expr(&#x27;cumulative_deceased/(population/100000)&#x27;).alias(&#x27;deaths_per_100k&#x27;),
            expr(&#x27;cumulative_persons_fully_vaccinated/(population - population_age_00_09)&#x27;).alias(&#x27;vaccination_rate&#x27;),
            col(&#x27;subregion2_code&#x27;).alias(&#x27;county_fips_code&#x27;))
joined = mask_use.join(opendata, &#x27;county_fips_code&#x27;)

joined.write.mode(&#x27;overwrite&#x27;).parquet(f&#x27;gs://{gcs_bucket}/demodata/covid_deaths_and_mask_usage/&#x27;)</code>
        </deckgo-highlight-code><p>Again, this is standard Spark DataFrame usage. The particulars are completely irrelevant to the OpenLineage data
collection- we don’t need to call any new APIs or change our code in any way. Here, I’ve filtered
the <code>covid19_open_data</code> table to include only U.S. data and to include the data for Halloween 2021. That dataset has a
large number of columns, but for my own purposes, I’m only interested in a few of them. I calculate <code>deaths_per_100k</code>
using the existing <code>cumulative_deceased</code> and <code>population</code> columns and I calculate the <code>vaccination_rate</code> using the total
population, subtracting the 0-9 year olds, since they weren’t eligible for vaccination at the time. For
the <code>mask_use_by_county</code> data, I don&#x27;t really care about the difference between <code>rarely</code> and <code>never</code>, so I combine them
into a single number. I do the same for <code>frequently</code> and <code>always</code>. I join the few columns I want from the two datasets
and store the combined result in GCS.</p><p>Add one more cell to the notebook and paste the following:</p><deckgo-highlight-code language="python" terminal="carbon">
          <code slot="code">spark.read.parquet(f&#x27;gs://{gcs_bucket}/demodata/covid_deaths_and_mask_usage/&#x27;).count()</code>
        </deckgo-highlight-code><p>The notebook will likely spit out a warning and a stacktrace (it should probably be a debug statement), then give you a
total of 3142 records.</p><p>So far, so good. Now what? If this was a data science blog, we might start generating some scatter plots or doing a
linear regression to determine whether frequent mask usage was a predictor of high death rates or vaccination rates.
But since we&#x27;re really focused on lineage collection, I&#x27;ll leave the rest of the analysis up to those with the time and
inclination to dig further. Instead, let&#x27;s switch to exploring the lineage records we just created.</p><p>The <code>docker-compose.yml</code> file that ships with the OpenLineage repo includes only the Jupyter notebook and the Marquez API.
For exploring visually, we’ll also want to start up the Marquez web project. Without terminating the existing docker
containers, run the following command in a new terminal:</p><deckgo-highlight-code language="bash" terminal="carbon">
          <code slot="code">docker run --network spark_default -p 3000:3000 -e MARQUEZ_HOST=marquez-api -e MARQUEZ_PORT=5000 --link marquez-api:marquez-api marquezproject/marquez-web:0.19.1</code>
        </deckgo-highlight-code><p>Now open a new browser tab and navigate to <code>http://localhost:3000</code>. You should see a screen like the following:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/8d5bf731fc49fa3ed295032c63fac76e/bf286/marquez_home.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:77.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVQ4y+2PSw6CMBRFWYaAtBSkVCg/0Uhcg8tx6tqvuUVQoxOjiRMHJ32vfT299Y7nE5TdYBGuYLsBVTdApCUWUQZf6HlNTYPc9jDVFkrXiLMKuuyxrncQKwtfajfnBSJHIHO3wSHWMzExrqY4SgoHe0mJ0Fiqtdtj7YQ+ZddG2Q5xSVpIUyPKLJZpgVAZJ9TFBmW7d4KmPyDRNZJ8hOfEm2RsmIaXA3Vbp3PCZEwUyDFZeE1/P/Mg/JQn4f1L7zJKvyh8+eW/8C/8kfACvDGcN51mnmgAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Marquez home page" title="Marquez home page" src="/static/8d5bf731fc49fa3ed295032c63fac76e/c1b63/marquez_home.png" srcSet="/static/8d5bf731fc49fa3ed295032c63fac76e/5a46d/marquez_home.png 300w,/static/8d5bf731fc49fa3ed295032c63fac76e/0a47e/marquez_home.png 600w,/static/8d5bf731fc49fa3ed295032c63fac76e/c1b63/marquez_home.png 1200w,/static/8d5bf731fc49fa3ed295032c63fac76e/bf286/marquez_home.png 1688w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>Note the spark_integration namespace was found for us and automatically chosen, since there are no other namespaces
available. We can see three jobs listed on the jobs page of the UI. They all start with <code>openlineage_spark_test</code>, which
is the <code>appName</code> we passed to the SparkSession we were building in the first cell of the notebook. Each query execution
or RDD action is represented as a distinct job and the name of the action is appended to the application name to form
the name of the job. Clicking on the <code>openlineage_spark_test.execute_insert_into_hadoop_fs_relation_command</code> node, we
can see the lineage graph for our notebook:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/ffa57e1abd4719f76061341c5b36fb59/46cee/marquez_job_graph.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:77.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABTUlEQVQ4y82U21KDMBCGeYoKcgwQCCFADaXH0TpVZ7zy/d/md7K1FbCn6ZUXH0uW3Z+fCRvLjQo8hjmcIEM5XaDSKwRJSes+iWggqhmKugPLasR5jUy1kPUcIa/ghPs6y4slJm4KvdiCly3yZo44N80dNYSpgu1zKrZ/xM3aHr3wgGUuD14KLjU5Ozb34hgn4HBO5A0k6IQ5Jm5yWuyME+eSwz4HsWu5q4Jjd/di3ePi/wjaZ3ZyuOPDWuuSwC2OxrUkaH5u35AqBLxCkCgEqYLHJD0zmBzdM/mbZ3Jfzyv4cUkMPpk3HVS7hqg7FGZSSk0INdvHakYj50YCHivgMQE/LeEn8qgxEDTzmqsWXD4hKaZIb8BMGC/1X0EDCYkpoqwi2BmiXoxFQ0ZOOtTLLXafX9i8fWC9e8fqdUcse+jlC54WzwOabkMnlhH8BnIUpYagNdQGAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Marquez job lineage" title="Marquez job lineage" src="/static/ffa57e1abd4719f76061341c5b36fb59/c1b63/marquez_job_graph.png" srcSet="/static/ffa57e1abd4719f76061341c5b36fb59/5a46d/marquez_job_graph.png 300w,/static/ffa57e1abd4719f76061341c5b36fb59/0a47e/marquez_job_graph.png 600w,/static/ffa57e1abd4719f76061341c5b36fb59/c1b63/marquez_job_graph.png 1200w,/static/ffa57e1abd4719f76061341c5b36fb59/46cee/marquez_job_graph.png 1687w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>The graph shows the <code>openlineage_spark_test.execute_insert_into_hadoop_fs_relation_command</code> job reads from two input
datasets, <code>bigquery-public-data.covid19_nyt.mask_use_by_county</code>
and <code>bigquery-public-data.covid19_open_data.covid19_open_data</code>, and writes to a third dataset,
<code>/demodata/covid_deaths_and_mask_usage</code>. The namespace is missing from that third dataset- the fully qualified name is
<code>gs://&lt;your_bucket&gt;/demodata/covid_deaths_and_mask_usage</code>.</p><p>Before clicking on the datasets, though, the bottom bar shows some really interesting data that was collected from the
Spark job. Dragging the bar up expands the view so we can get a better look at that data.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/7d491045a0d8ba81aae897a738269a52/46cee/marquez_job_facets.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:77.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvUlEQVQ4y42T6XKbMBSFeYpOHRyzhU2YfREYENhxkknz/s9zOlcYSkrr5Mfna3ng0+HIKKru40FzsTs4CGKOMGtwsAK5XmN5MbywgB+VMJ0IphvBOeZgUQXNDrHTpuuUvcnwQ7WQcQE7yODGJUyXbi7hBDm0pyN+PtpfMm+s0Acl9KIKuh1hp7lQdU/yMKN52Bu+/E6/7w0m1xKTSVTDl0ghXUS76CyBHRWwvERC6XQ7hO6EchpOhEeTYQ6xO7hQLYa9xeSmhDJHJaEXV0jKDsesBkuqhSDlYHGFY1rLHqnPJz+R2CyVzA5lXfyUwJcp/gcdGCWfMeQBxVshLaKiRTu+oWgH5Ccx0dLsF6LihDBvPhGktaxgI0y5wPDygXq4oupH5I1AtqbukVTdhrhs/y2k3dvzG3h/Qdb0N4ScS+JGSMEMCem+jZCg0vvnd4jrL/BuXAR/C2lS2rtCWtBbUosrynZcRHPK+dHm+a2E9Peougtq8TwdTCOQ8h5pfYP3G/GXwrwZ0I6v4OIMPpxRjxdUYkTR/ulvfRh3hSyZEo4vH6i6ESnvpoQ3Et6thN985Pw0SikJ1l2tO7vX4W+wBsbF8KJqgQAAAABJRU5ErkJggg==&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Marquez job facets" title="Marquez job facets" src="/static/7d491045a0d8ba81aae897a738269a52/c1b63/marquez_job_facets.png" srcSet="/static/7d491045a0d8ba81aae897a738269a52/5a46d/marquez_job_facets.png 300w,/static/7d491045a0d8ba81aae897a738269a52/0a47e/marquez_job_facets.png 600w,/static/7d491045a0d8ba81aae897a738269a52/c1b63/marquez_job_facets.png 1200w,/static/7d491045a0d8ba81aae897a738269a52/46cee/marquez_job_facets.png 1687w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>Two <a href="https://openlineage.io/blog/extending-with-facets/">facets</a> that are always collected from Spark jobs are
the <code>spark_version</code> and the <code>spark.logicalPlan</code>. The first simply reports what version of Spark was executing, as well
as the version of the <code>openlineage-spark</code> library. This is helpful information to collect when trying to debug a job
run.</p><p>The second facet is the serialized optimized <code>LogicalPlan</code> Spark reports when the job runs. Spark’s query optimization
can have dramatic effects on the execution time and efficiency of the query job. Tracking how query plans change over
time can significantly aid in debugging slow queries or OutOfMemory errors in production.</p><p>Clicking on the first BigQuery dataset gives us information about the data we read:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/c9a8e4626f94045e806f8562f3b4d2b8/3a1b1/marquez_bigquery_dataset_latest.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:77.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVQ4y51U2ZKbQAzkK7JZAwbMMcBwnwYbH2vnJU/5/5/plEQgGLu2tvahC2mm1Ug9A4pq+vih2hBRibTs4QQ55+9bDz91l7G1JURUQWYt83YihRPmCJIGQVJDdyTzCQoViLSGrHouIkEqNN2YC940ZyZvDDG/aMqntYWgBy+qEKQNEzemD9UKsDF8aFbAJJqCwAJzvII5QqFiIhheAjdtYIcFPDmOZXoJLJFCtyX0XcgvmPgUT/nWjqBZ475CHbypNiyRQMQVLC/mcUdEnJOH7KfmsBjtTf6uobxvBQfUgWFP5roPvuxEAs3yOTYcCT+uZv/UlY8sSMYbTsSFo2fiocD2M+6MBW3JJzvtj/h/UOPImsPjkShtkuAStD4dCk1C/i73aX0hOHZI96vqL4iK/RNkvs7bOY7Lji14EnRlge78C+3piupwRt4OyJrjS+TtMh743j6NTILN8QPNcGFiWh++BOKGWfNasB1uaIYrsvY4kz8DcajDTwVp5GI/fF9wOiFvIZj/E3yNI7L6Kx2GOerDlT2cTV8/GQekzaOH9B8gDf5S6F7RXYqKDvfff9Cd7+guN/TX+wo3Rnv6YJ/L7oxyf+KrlpQ9f0n6LsBf2XXc3CTGYhIAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Marquez dataset latest facet" title="Marquez dataset latest facet" src="/static/c9a8e4626f94045e806f8562f3b4d2b8/c1b63/marquez_bigquery_dataset_latest.png" srcSet="/static/c9a8e4626f94045e806f8562f3b4d2b8/5a46d/marquez_bigquery_dataset_latest.png 300w,/static/c9a8e4626f94045e806f8562f3b4d2b8/0a47e/marquez_bigquery_dataset_latest.png 600w,/static/c9a8e4626f94045e806f8562f3b4d2b8/c1b63/marquez_bigquery_dataset_latest.png 1200w,/static/c9a8e4626f94045e806f8562f3b4d2b8/3a1b1/marquez_bigquery_dataset_latest.png 1686w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>Here, we can see the schema of the dataset as well as the datasource — namely BigQuery.</p><p>We can get similar information about the dataset written to in GCS:</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/02147959a05b5e3aa90ec2f195883704/bf286/marquez_output_dataset_latest.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:77.33333333333333%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABsklEQVQ4y6VSWXKbQBDVKWxZgBiWGXYQuwAJrKjylfuf56WmB7BQyeVU5ePR9PZ6m53GAhxMDx9HgShrkeQdjk5E+iMcP4OfVAiSGpZIYXspRFwiTBuYPMGHqeJ2uh3iTXNRtBN4WBCcMEdYdhBRCdONsTf4hnxvCOyfCi7Yyc+7zolIdvacrAj4y+RXMbvF8KY5eNddcvwPiFBjPjQrwIH5tE+SM8jHAuhWSHKJXf+foAgt5TRFAuZnYDwhGHa4FtJlzBwniy6FpDTsSPlZ8DWyHJdHBV1OXlRe0fYy8lHXpljHkruWtm9HXpZqixRHJ3wg8XA4CjAew5JPY15PmNZkU7q3PrvNUSSh7MzZdKUCTSdSBAYnmxeXYK4k5Gv3C8eG0PVPsERCXejWvDfmU9dyTG3epZrkS5exLwnTskcz3HBqBqRVT7qUSdkR1H+PuDjPNuWX+rLTDWHejph+/0E73dCON5w/fxEWXcr6MqHsR1T9SFIiq4bXhGk1oL3ekZ+vyNsLsnr4EafmQl2+JIyLDufxjmb8RN5ekdUXSvgOPxImRYd2vKMapjX4MfFfCP8CmZqzOOeO82sAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Marquez output dataset latest facet" title="Marquez output dataset latest facet" src="/static/02147959a05b5e3aa90ec2f195883704/c1b63/marquez_output_dataset_latest.png" srcSet="/static/02147959a05b5e3aa90ec2f195883704/5a46d/marquez_output_dataset_latest.png 300w,/static/02147959a05b5e3aa90ec2f195883704/0a47e/marquez_output_dataset_latest.png 600w,/static/02147959a05b5e3aa90ec2f195883704/c1b63/marquez_output_dataset_latest.png 1200w,/static/02147959a05b5e3aa90ec2f195883704/bf286/marquez_output_dataset_latest.png 1688w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>As in the BigQuery dataset, we can see the output schema and the datasource — here, the <code>gs://</code> scheme and the name of
the bucket we wrote to. </p><p>In addition to the schema, we also see a <code>stats</code> facet, reporting the number of output records and bytes as -1. A
somewhat recent change to the OpenLineage schema resulted in output facets being recorded in a new field- one that
Marquez is not yet reading from. The old, deprecated facet reports the output stats incorrectly. An upcoming bugfix
should correct the stats view so that we can see the number of rows written as well as the number of output bytes (the
statistics are actually recorded correctly- the API simply needs to start returning the correct values).</p><p>You may have noticed the <code>VERSIONS</code> tab on the bottom bar. We can click it, but since the job has only ever run once,
we’ll only see one version. Clicking on the version, we’ll see the same schema and statistics facets, but specific
to the version we clicked.</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1200px;margin:3rem">
      <a class="gatsby-resp-image-link" href="/static/974ed6f9d743ebaf5d1f89fc3e783cc5/46cee/marquez_output_dataset_version.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:77.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7ElEQVQ4y5VU23KiQBD1J3aTKKByFRhFLgIioCZV2X3Y//+ds3V6hIib2koeDj3d03Po28xssdrg58JBoHLs8gZemOLH3Maz6eHJcEVaToRAFYj3lfjZQQI3ShHuDgLTjfFi+YIZP16UIUoqOURHVbZY+VuEu1JI58tgAp6Z6DebEPKAG+q/MRo6GOtQJKOn7TuQCP/nMPz5qxgJxUBJIsP7dmRjhEzPdGIY60iwWEcw/S1MR8GwI5h2DMtRsNwPnf4ib+D+sJ6xVrqOexR1j7RskVQtfJVj6cT/pP5ZKVjrMWUScmw2KkfTveJQdwhVLmkPTqYdjWTMyA52eLEe6vvYFB5iRE+mq/96G4nFKhACY7XB3PJhOTE220Lssn/zG6IWQqZMRz/ORkcNPW9OkIxpccg5Yvf7lBNCKitPSR158BFLNmQdypqZ8KYYa72n5SRC3RReqcPpin11wq5osM2PI1Q2Xau01np2FN/hUkwI2dXL+x8cz28ouwuq/or6fBVJvewvIvOmR37UyG6Sd3wkHMaGEZ6uv7Rz0yOrO6RVi7QaZHundx/2ukN0Tzg0hY8CUz60FyFLDickxUnLe9zZmO6+bBHty/FlmrHILC5HoX39jfbtHfnxjKzuRQ7pfYq6R9Gc5dnTDQrxF46D0UTbqa1JAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="Marquez output dataset version info" title="Marquez output dataset version info" src="/static/974ed6f9d743ebaf5d1f89fc3e783cc5/c1b63/marquez_output_dataset_version.png" srcSet="/static/974ed6f9d743ebaf5d1f89fc3e783cc5/5a46d/marquez_output_dataset_version.png 300w,/static/974ed6f9d743ebaf5d1f89fc3e783cc5/0a47e/marquez_output_dataset_version.png 600w,/static/974ed6f9d743ebaf5d1f89fc3e783cc5/c1b63/marquez_output_dataset_version.png 1200w,/static/974ed6f9d743ebaf5d1f89fc3e783cc5/46cee/marquez_output_dataset_version.png 1687w" sizes="(max-width: 1200px) 100vw, 1200px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><p>In production, this dataset would have many versions, as each time the job runs a new version of the dataset is created.
This allows us to track changes to the statistics and schema over time, again aiding in debugging slow jobs (suddenly,
we started writing 50% more records!) or data quality issues (suddenly, we’re only writing half as many records as
normal!) and job failures (somebody changed the output schema and downstream jobs are failing!).</p><p>The final job in the UI is a HashAggregate job- this represents the <code>count()</code> method we called at the end to show the
number of records in the dataset. Rather than a <code>count()</code>, this could easily be a <code>toPandas()</code> call or some other job
that reads and processes that data- perhaps storing output back into GCS or updating a Postgres database or publishing a
new model, etc. Regardless of where the output gets stored, the OpenLineage integration allows you to see the entire
lineage graph, unifying datasets in object stores, relational databases, and more traditional data warehouses.</p><p><a href="https://xkcd.com/2347/"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:385px;margin:3rem">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:127%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsTAAALEwEAmpwYAAADgUlEQVQ4y4WUW3OySBCG8///Qu5zkxirTOUgnkBARhBQDoICcnKCHDUqlhh1vkrIbrnZZPe9mqmaZ7qn++25mkwm6/Xa87wgCMIwnEwms9nMsizf9x3HsW0bQphlWXqhOI7zPKco6iqKIoSQZVmapoVhSJIkjuMURcmyTFEUwzCmaSKEzucz+kun0wkhJMvyVRiG5Z5lWQDAcDgEAAiCoGkaz/OCIJTkpY7HI0JIkqSvyGmaLhaLOI6TJPE8z/d9CGEQBBDCzWbza+QSXq1W5Yk4jsuLDcOo1Wq73a6EL/UdLoGiKG5vb7fbLUKo2+1eX18HQfAt7A+woigIodlsVqlUEEK6rouiaFkWAGC32/1PwZ6enmRZDoLg8fERIUTTNI7jkiS9vLys1+tf4TiOEUJ3d3eapmVZxvM8QkgQhGq1iuN4s9l8f3//FU6S5Hg8VioVDMMAAK1W63A4pGkqCILrugzD/Neby7Qpimq1Wo1Gg6bp/X5fFEW1WgUAKIrydyN+gNM03e12JElyHDcYDAiCME1T13WGYWRZFkXx/v6+zPx0Ol2a5APOsmyz2YiiaNu2aZqWZTEMg2GY67qKomia1ul0fu1zmqbb7VZV1fl87rru6+trq9W6ublpt9s4jtfr9efn59Vq5TiOYRiu60ZRNJlM8jxXVfULVhTF933XdWezGcMwjuNYn7Jt27IsWZbb7TZBEJIk9fv9er2eZdl4PP6A8zxXFGU+n3ueZ9s2SZI8z4uiOBwOOY6TJGkymXS7XZIkR6MRz/P9fh9C+AVvt1tJklzXLeMQBCHLsq7rpmkqiqLrenkjSZIYhlEUxXGcLMsfU5UkyeFwYBiGZdl+v9/r9drtNs/zAABRFAeDgeM4qqo2m02e53u9Hk3T4/E4DMMPuHSYYRie5zmfghD6n/I8bzqdlkP68PDQ7XZrtRrHcWXNv+x5Pp9VVS37ZJrmdDo1DKPcjsfjKIqCIGBZNkkSSZIghKVhPiKXDrMsq1arYRjWbDZpmu71ehzHEQTRaDTe3t6Korj8Er7b0/f9sqUsyxZFsd1uD4cDhLDT6fi+n2XZpcn+MRjL5VIQBI7jAACSJJUJz2YzXddVVZ1Op/v9/meHeZ7HMAxJkgAA7lMsy5bFL9fdbnc0Gi2Xyx/ShhCGYVh+2nEcR1G0WCzSNI2iKAzD5FMQwjzP/w3/AbmSMDujwkmBAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="XKCD 2347" title="XKCD 2347" src="/static/31d211ab466826648a9727227ff6358c/409e6/dependency.png" srcSet="/static/31d211ab466826648a9727227ff6358c/5a46d/dependency.png 300w,/static/31d211ab466826648a9727227ff6358c/409e6/dependency.png 385w" sizes="(max-width: 385px) 100vw, 385px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></a></p><p>The Spark integration is still a work in progress, but users are already getting insights into their graphs of datasets
stored in object stores like S3, GCS, and Azure Blob Storage, as well as BigQuery and relational databases like
Postgres. Now with Spark 3.1 supported, we can gain visibility into more environments, like Databricks, EMR, and
Dataproc clusters.</p><p>Data lineage gives visibility to the (hopefully) high quality, (hopefully) regularly updated datasets that everyone
depends on, maybe without even realizing it. Spark helped usher in a welcome age of data democratization. Now data
observability can help ensure we’re making the best possible use of the data available.</p></div></div><footer class="footer bg-bgalt py-12"><div class="container mx-auto text-center"><div class="flex justify-center my-3 mb-6"><a title="OpenLineage" href="/"><img src="/images/ol-logo.svg" alt="OpenLineage - logo" class="w-40"/></a></div><div class="text-color-2 my-3 footer-links animated-link-parent"><ul class="flex items-center justify-center flex-wrap"><li class=" "><a title="Home" class="text-color-2 focus:text-primary" href="/"><span>Home</span></a></li><li class=" "><a title="Getting Started" class="text-color-2 focus:text-primary" href="/getting-started"><span>Getting Started</span></a></li><li class=" "><a title="Integrations" class="text-color-2 focus:text-primary" href="/integration"><span>Integrations</span></a></li><li class=" "><a title="Resources" class="text-color-2 focus:text-primary" href="/resources"><span>Resources</span></a></li><li class=" "><a title="Blog" class="text-color-2 focus:text-primary" href="/blog"><span>Blog</span></a></li><li class=" "><a title="Ecosystem" class="text-color-2 focus:text-primary" href="/ecosystem"><span>Ecosystem</span></a></li><li class=" "><a title="Docs" class="text-color-2 focus:text-primary" href="/docs"><span>Docs</span></a></li></ul></div><div class="text-color-2 my-3"><ul><li class="inline-block mx-3 animated-link-parent"><a href="https://twitter.com/OpenLineage" title="Twitter"><span>Twitter</span></a></li><li class="inline-block mx-3 animated-link-parent"><a href="http://bit.ly/OpenLineageSlack" title="Slack"><span>Slack</span></a></li><li class="inline-block mx-3 animated-link-parent"><a href="https://github.com/OpenLineage/OpenLineage" title="GitHub"><span>GitHub</span></a></li></ul></div><p class="text-color-default text-lg">Copyright © <!-- -->2022<!-- --> The Linux Foundation®. All rights reserved.</p></div></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/openlineage-spark/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-b5a5dbb1060cd6f20f46.js"],"app":["/app-451991c301b94b91c1ec.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-9f423a0461078a54f8ef.js"],"component---src-pages-contact-tsx":["/component---src-pages-contact-tsx-144c2cbcdce5dce15a6e.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-82a1131f931451bbaa5a.js"],"component---src-templates-basepages-tsx":["/component---src-templates-basepages-tsx-81225bbcb5c10501d181.js"],"component---src-templates-blog-list-tsx":["/component---src-templates-blog-list-tsx-31d83b2f6394db868c0e.js"],"component---src-templates-blog-tsx":["/component---src-templates-blog-tsx-ea74284cf1c1eab694cf.js"],"component---src-templates-integration-list-tsx":["/component---src-templates-integration-list-tsx-27189bf1afa810bbd594.js"],"component---src-templates-integration-tsx":["/component---src-templates-integration-tsx-7f35005c2787bfe3c74d.js"]};/*]]>*/</script><script src="/polyfill-b5a5dbb1060cd6f20f46.js" nomodule=""></script><script src="/component---src-templates-blog-tsx-ea74284cf1c1eab694cf.js" async=""></script><script src="/03af1e3b4838e2bf1feefdfdd4602b9a79f8e4c9-6dd2fc84b6bd0dd0e21b.js" async=""></script><script src="/commons-6492f9ca47f71b394b27.js" async=""></script><script src="/app-451991c301b94b91c1ec.js" async=""></script><script src="/framework-c3c70a738d76c2aa5adb.js" async=""></script><script src="/webpack-runtime-f31cb342322c040ab001.js" async=""></script></body></html>